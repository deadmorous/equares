{"name":"interactive-phase-portrait-4","description":"Interactive phase portrait, #4","info":"# Interactive phase portrait\n\nThis example generates one phase trajectory of a 2D system each time users clicks on the image representing the phase plane. The trajectory goes in both directions from the point clicked. The color of the trajectory is blue in the time increment direction and is read in the time decrement direction.\n\nFor more information, please see =[this simulation](/editor?sim=damped-pendulum-interactive-phase-portrait).","keywords":["phase portrait","phase trajectory","example","tutorial","tutorial interactive-phase-portrait 4"],"script":"var h = 0.001\n","public":true,"definition":"{\"boxes\":[{\"name\":\"odeParam\",\"type\":\"Param\",\"props\":{\"data\":{\"value\":{\"l\":\"1\",\"g\":\"9.8\",\"n\":\"0.1\"}}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":167.671875,\"y\":132,\"ports\":[{\"pos\":3.5}]},{\"name\":\"initState\",\"type\":\"Param\",\"props\":{\"data\":{\"value\":{\"q\":0,\"dq\":0,\"t\":0}}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":606.671875,\"y\":132,\"ports\":[{\"pos\":2.558437189632525}]},{\"name\":\"ode\",\"type\":\"CxxOde\",\"props\":{\"src\":{\"value\":\"/*#\\ntitle: Damped pendulum\\nkeywords: pendulum\\n\\n# Damped pendulum\\n\\nThe damped pendulum equation of motion is as follows:\\n$$\\n\\\\ddot\\\\varphi + 2n\\\\dot\\\\varphi + \\\\frac gl \\\\sin\\\\varphi = 0\\n$$\\nIt is similar to ?[simple pendulum](/doc#box/Pendulum),\\nbut here we have the additional term $2n\\\\dot\\\\varphi$.\\n*/\\n\\n#include <cmath>\\n\\nstruct DampedPendulum {\\n    int paramCount() const {\\n        return 3;       // l, g, n\\n    }\\n    const char *paramNames() const {\\n        return \\\"l,g,n\\\";   // Can also return empty string or null ptr\\n    }\\n    int varCount() const {\\n        return 2;       // q, dq\\n    }\\n    const char *varNames() const {\\n        return \\\"q,dq\\\";  // Can also return empty string or null ptr\\n    }\\n\\n    // Auxiliary parameters\\n    double g_l, _2n;\\n    void prepare(const double *param) {\\n        g_l = param[1]/param[0];\\n        _2n = 2*param[2];\\n    }\\n\\n    void rhs(double *out, const double *param, const double *state) const {\\n        out[0] = state[1];\\n        out[1] = -g_l * sin(state[0]) - _2n*state[1];\\n    }\\n};\\n\\n\"},\"srcExample\":{\"value\":\"#include <cmath>\\n\\nstruct pendulum {\\n    int paramCount() const {\\n        return 2;       // l, g\\n    }\\n    const char *paramNames() const {\\n        return \\\"l,g\\\";   // Can also return empty string or null ptr\\n    }\\n    int varCount() const {\\n        return 2;       // q, dq\\n    }\\n    const char *varNames() const {\\n        return \\\"q,dq\\\";  // Can also return empty string or null ptr\\n    }\\n\\n    // Auxiliary parameters\\n    double g_l;\\n    void prepare(const double *param) {\\n        g_l = param[1]/param[0];\\n    }\\n\\n    void rhs(double *out, const double *param, const double *state) const {\\n        out[0] = state[1];\\n        out[1] = -g_l * sin(state[0]);\\n    }\\n};\\n\"},\"useQmake\":{\"value\":true}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":192.671875,\"y\":206,\"ports\":[{\"pos\":1.4908018355819235},{\"pos\":0.7},{\"pos\":0.3}]},{\"name\":\"solver\",\"type\":\"Rk4\",\"props\":{},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":331.671875,\"y\":206,\"ports\":[{\"pos\":1.2375968630210972},{\"pos\":1.7105667137878378},{\"pos\":2.7},{\"pos\":0.5},{\"pos\":3.8531015478424013},{\"pos\":2.3},{\"pos\":3.1989583333333336}]},{\"name\":\"canvas\",\"type\":\"Canvas\",\"props\":{\"param\":{\"value\":{\"x\":{\"vmin\":\"-6\",\"vmax\":\"6\",\"resolution\":350},\"y\":{\"vmin\":\"-12\",\"vmax\":\"12\",\"resolution\":350}}},\"refreshInterval\":{\"value\":0},\"timeCheckCount\":{\"value\":100},\"clearOnRestart\":{\"value\":false},\"withInputValue\":{\"value\":true}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":375.671875,\"y\":470.9999694824219,\"ports\":[{\"pos\":1.1654711546911698},{\"pos\":1.93301951873109},{\"pos\":2.5},{\"pos\":0.551923360595283},{\"pos\":3.5}]},{\"name\":\"bitmap\",\"type\":\"Bitmap\",\"props\":{\"fileName\":{\"value\":\"result.png\"},\"valueRange\":{\"value\":{\"vmin\":\"-h\",\"vmax\":\"2*h\"}},\"colorMap\":{\"value\":[{\"pos\":0,\"color\":16711680},{\"pos\":\"0.333\",\"color\":16777215},{\"pos\":\"0.667\",\"color\":3161087},{\"pos\":\"1\",\"color\":16777215}]}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":379.6718444824219,\"y\":535,\"ports\":[{\"pos\":1.5443905538651086}]},{\"name\":\"proj\",\"type\":\"Projection\",\"props\":{\"indices\":{\"value\":[0,1]}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":398.65625,\"y\":276,\"ports\":[{\"pos\":1.8003},{\"pos\":3.3977564102564104}]},{\"name\":\"isInput\",\"type\":\"PointInput\",\"props\":{\"transform\":{\"value\":{\"x\":{\"index\":0,\"vmin\":\"-6\",\"vmax\":\"6\",\"resolution\":350},\"y\":{\"index\":1,\"vmin\":\"-12\",\"vmax\":\"12\",\"resolution\":350}}},\"refBitmap\":{\"value\":\"result.png\"},\"restartOnInput\":{\"value\":false},\"activateBeforeRestart\":{\"value\":false}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":462.0000305175781,\"y\":133,\"ports\":[{\"pos\":1.2925837320574163},{\"pos\":0.48625850340136056},{\"pos\":3.6412795125666415},{\"pos\":1.9562461995057552}]},{\"name\":\"isSplit\",\"type\":\"Split\",\"props\":{\"outputPortCount\":{\"value\":4}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":364,\"y\":63,\"ports\":[{\"pos\":3.817868761867822},{\"pos\":3.424539358486851},{\"pos\":2.520827215376178},{\"pos\":0.3171225695076619},{\"pos\":0.7017511036310503}]},{\"name\":\"replicator\",\"type\":\"Replicator\",\"props\":{},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":318,\"y\":133,\"ports\":[{\"pos\":1.931228366827403},{\"pos\":1.3},{\"pos\":3.6853833803085205},{\"pos\":3.3246108368606495}]},{\"name\":\"solverParam\",\"type\":\"ParamArray\",\"props\":{\"data\":{\"value\":[{\"h\":\"h\",\"n\":\"100000\",\"nout\":\"1\"},{\"h\":\"-h\",\"n\":\"100000\",\"nout\":\"1\"}]},\"withActivator\":{\"value\":true}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":190,\"y\":65,\"ports\":[{\"pos\":0.5294117647058824},{\"pos\":3.9250025576246093},{\"pos\":2.4746323529411764}]},{\"name\":\"flushFilter\",\"type\":\"CountedFilter\",\"props\":{},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":261,\"y\":278,\"ports\":[{\"pos\":2.5},{\"pos\":1.29255408117752},{\"pos\":3.96932976408612}]},{\"name\":\"flushFilterParam\",\"type\":\"Param\",\"props\":{\"data\":{\"value\":{\"count\":\"2\"}}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":64,\"y\":276,\"ports\":[{\"pos\":0.4495798319327731}]},{\"name\":\"clickedPoints\",\"type\":\"Dump\",\"props\":{\"fileName\":{\"value\":\"clickedPoints.txt\"}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":499,\"y\":62,\"ports\":[{\"pos\":2.7174900903349206},{\"pos\":2.314759995715977}]},{\"name\":\"pause\",\"type\":\"Pause\",\"props\":{},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":134,\"y\":388,\"ports\":[{\"pos\":1.5}]},{\"name\":\"proj_h\",\"type\":\"Projection\",\"props\":{\"indices\":{\"value\":[0]}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":488.8333282470703,\"y\":275,\"ports\":[{\"pos\":1.5},{\"pos\":3.5}]},{\"name\":\"repl_h\",\"type\":\"Replicator\",\"props\":{},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":435.8332977294922,\"y\":338,\"ports\":[{\"pos\":1.7},{\"pos\":1.3},{\"pos\":3.3},{\"pos\":3.7}]},{\"name\":\"join_h\",\"type\":\"Join\",\"props\":{},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":435.8332977294922,\"y\":401,\"ports\":[{\"pos\":1.7},{\"pos\":1.3},{\"pos\":3.2790502546819855}]},{\"name\":\"pan-zoom\",\"type\":\"RectInput\",\"props\":{\"initRect\":{\"value\":{\"xmin\":\"-6\",\"xmax\":\"6\",\"ymin\":\"-12\",\"ymax\":\"12\"}},\"keepAspectRatio\":{\"value\":false},\"withActivator\":{\"value\":false},\"restartOnInput\":{\"value\":true},\"refBitmap\":{\"value\":\"result.png\"}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":642.8333282470703,\"y\":333,\"ports\":[{\"pos\":2.559498001500024}]}],\"links\":[{\"source\":{\"box\":\"solver\",\"port\":\"nextState\"},\"target\":{\"box\":\"proj\",\"port\":\"input\"}},{\"source\":{\"box\":\"initState\",\"port\":\"output\"},\"target\":{\"box\":\"isInput\",\"port\":\"input\"}},{\"source\":{\"box\":\"ode\",\"port\":\"parameters\"},\"target\":{\"box\":\"odeParam\",\"port\":\"output\"}},{\"source\":{\"box\":\"ode\",\"port\":\"state\"},\"target\":{\"box\":\"solver\",\"port\":\"rhsState\"}},{\"source\":{\"box\":\"ode\",\"port\":\"oderhs\"},\"target\":{\"box\":\"solver\",\"port\":\"rhs\"}},{\"source\":{\"box\":\"canvas\",\"port\":\"output\"},\"target\":{\"box\":\"bitmap\",\"port\":\"input\"}},{\"source\":{\"box\":\"isSplit\",\"port\":\"input\"},\"target\":{\"box\":\"isInput\",\"port\":\"output\"}},{\"source\":{\"box\":\"replicator\",\"port\":\"value_out\"},\"target\":{\"box\":\"solver\",\"port\":\"initState\"}},{\"source\":{\"box\":\"isSplit\",\"port\":\"out_1\"},\"target\":{\"box\":\"replicator\",\"port\":\"value_in\"}},{\"source\":{\"box\":\"solver\",\"port\":\"parameters\"},\"target\":{\"box\":\"replicator\",\"port\":\"control_out\"}},{\"source\":{\"box\":\"solverParam\",\"port\":\"activator\"},\"target\":{\"box\":\"isSplit\",\"port\":\"out_2\"}},{\"source\":{\"box\":\"solverParam\",\"port\":\"output\"},\"target\":{\"box\":\"replicator\",\"port\":\"control_in\"}},{\"source\":{\"box\":\"flushFilterParam\",\"port\":\"output\"},\"target\":{\"box\":\"flushFilter\",\"port\":\"count\"}},{\"source\":{\"box\":\"flushFilter\",\"port\":\"input\"},\"target\":{\"box\":\"solver\",\"port\":\"finish\"}},{\"source\":{\"box\":\"flushFilter\",\"port\":\"output\"},\"target\":{\"box\":\"canvas\",\"port\":\"flush\"}},{\"source\":{\"box\":\"replicator\",\"port\":\"control_out\"},\"target\":{\"box\":\"proj_h\",\"port\":\"input\"}},{\"source\":{\"box\":\"repl_h\",\"port\":\"control_in\"},\"target\":{\"box\":\"proj\",\"port\":\"output\"}},{\"source\":{\"box\":\"repl_h\",\"port\":\"control_out\"},\"target\":{\"box\":\"join_h\",\"port\":\"in_1\"}},{\"source\":{\"box\":\"repl_h\",\"port\":\"value_out\"},\"target\":{\"box\":\"join_h\",\"port\":\"in_2\"}},{\"source\":{\"box\":\"canvas\",\"port\":\"input\"},\"target\":{\"box\":\"join_h\",\"port\":\"out\"}},{\"source\":{\"box\":\"proj_h\",\"port\":\"output\"},\"target\":{\"box\":\"repl_h\",\"port\":\"value_in\"}},{\"source\":{\"box\":\"isInput\",\"port\":\"range\"},\"target\":{\"box\":\"pan-zoom\",\"port\":\"output\"}},{\"source\":{\"box\":\"canvas\",\"port\":\"range\"},\"target\":{\"box\":\"pan-zoom\",\"port\":\"output\"}},{\"source\":{\"box\":\"clickedPoints\",\"port\":\"flush\"},\"target\":{\"box\":\"isSplit\",\"port\":\"out_4\"}},{\"source\":{\"box\":\"isSplit\",\"port\":\"out_3\"},\"target\":{\"box\":\"clickedPoints\",\"port\":\"input\"}}]}"}