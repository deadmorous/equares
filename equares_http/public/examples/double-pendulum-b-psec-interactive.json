{"name":"double-pendulum-b-psec-interactive","description":"Double pendulum b, Poincare map (interactive)","info":"# Double pendulum b, Poincare map (interactive)\n\nGenerates Poincare map for modified double pendulum system. The difference between this system and the conventional double pendulum is that the two links of the pendulum move in two mutually perpendicular planes (both vertical). \n\nMap cross-section is the hyperplane q2=0. The output is the projection of Poincare map onto plane (q1, dq1).\n\nUser can change initial conditions by moving sliders (due to **isInput** box of type ?[RangeInput](/doc#box/RangeInput)\n\nThis example also shows how to use the ?[CxxOde](/doc#box/CxxOde) box that allows user to provide his/her own ODE system.","keywords":["poincare map","double pendulum","chaos","example"],"script":"","public":true,"definition":"{\"boxes\":[{\"name\":\"odeParam\",\"type\":\"Param\",\"props\":{\"data\":{\"value\":{\"l1\":1,\"m1\":1,\"l2\":0.6,\"m2\":1,\"g\":9.8}}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":111.671875,\"y\":94,\"ports\":[{\"pos\":3.5}]},{\"name\":\"solverParam\",\"type\":\"Param\",\"props\":{\"data\":{\"value\":{\"h\":0.002,\"n\":0,\"nout\":1}}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":244.671875,\"y\":94,\"ports\":[{\"pos\":3.5}]},{\"name\":\"initState\",\"type\":\"Param\",\"props\":{\"data\":{\"value\":{\"q1\":\"0.02513\",\"q2\":\"1.15296\",\"dq1\":\"-2.34\",\"dq2\":\"2.28\",\"t\":0}}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":432.671875,\"y\":94,\"ports\":[{\"pos\":3.4901784451956197}]},{\"name\":\"ode\",\"type\":\"CxxOde\",\"props\":{\"src\":{\"value\":\"#include <cmath>\\n\\nstruct DoublePendulum {\\n    int paramCount() const {\\n        return 5;   // l1, m1, l2, m2, g\\n    }\\n    const char *paramNames() const {\\n        return \\\"l1, m1, l2, m2, g\\\";\\n    }\\n    int varCount() const {\\n        return 4;   // q1, q2, dq1, dq2\\n    }\\n    const char *varNames() const {\\n        return \\\"q1, q2, dq1, dq2\\\";\\n    }\\n\\n    // Auxiliary parameters\\n    double\\n        L1,\\n        M1,\\n        L2,\\n        M2,\\n        G,\\n        L12,\\n        L22,\\n        L12m,\\n        L22m,\\n        L1mg,\\n        L2mg;\\n    void prepare(const double *param) {\\n        L1 = param[0];\\n        M1 = param[1];\\n        L2 = param[2];\\n        M2 = param[3];\\n        G = param[4];\\n        L12 = L1*L1;\\n        L22 = L2*L2;\\n        L12m = L12*M1;\\n        L22m = L22*M2;\\n        L1mg = L1*M1*G;\\n        L2mg = L2*M2*G;\\n    }\\n\\n    void rhs(double *out, const double *param, const double *state) const {\\n        out[0] = state[2];\\n        out[1] = state[3];\\n\\tdouble\\n            phi = state[0],\\n            psi = state[1],\\n            dphi = state[2],\\n            dpsi = state[3],\\n            sphi = sin(phi),\\n            spsi = sin(psi),\\n            cphi = cos(phi),\\n            cpsi = cos(psi),\\n\\n            c = L1+L2*cpsi,\\n\\n            aphi = L12m + M2*c*c,\\n            daphi = -2*M2*c*L2*dpsi*spsi,\\n\\n            fphi = -daphi*dphi - G*sphi*((M1+M2)*L1 + M2*L2*cpsi),\\n            ddpsi = (-c*spsi*dphi*dphi - G*cphi*spsi)/L2;\\n\\tout[2] = fphi/aphi;\\n\\tout[3] = ddpsi;\\n    }\\n};\\n\"},\"srcExample\":{\"value\":\"#include <cmath>\\n\\nstruct pendulum {\\n    int paramCount() const {\\n        return 2;       // l, g\\n    }\\n    const char *paramNames() const {\\n        return \\\"l,g\\\";   // Can also return empty string or null ptr\\n    }\\n    int varCount() const {\\n        return 2;       // q, dq\\n    }\\n    const char *varNames() const {\\n        return \\\"q,dq\\\";  // Can also return empty string or null ptr\\n    }\\n\\n    // Auxiliary parameters\\n    double g_l;\\n    void prepare(const double *param) {\\n        g_l = param[1]/param[0];\\n    }\\n\\n    void rhs(double *out, const double *param, const double *state) const {\\n        out[0] = state[1];\\n        out[1] = -g_l * sin(state[0]);\\n    }\\n};\\n\"},\"useQmake\":{\"value\":true}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":134.671875,\"y\":190,\"ports\":[{\"pos\":1.5},{\"pos\":0.7},{\"pos\":0.3}]},{\"name\":\"solver\",\"type\":\"Rk4\",\"props\":{},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":271.671875,\"y\":190,\"ports\":[{\"pos\":1.5357074175824175},{\"pos\":0.668288222136102},{\"pos\":2.7},{\"pos\":3.67465086996337},{\"pos\":0.012096313727252117},{\"pos\":2.3},{\"pos\":3.2983691199151726}]},{\"name\":\"canvas\",\"type\":\"Canvas\",\"props\":{\"param\":{\"value\":{\"x\":{\"vmin\":\"-1.570796327\",\"vmax\":\"1.570796327\",\"resolution\":500},\"y\":{\"vmin\":\"-6.283185307\",\"vmax\":\"5.654866776\",\"resolution\":500}}},\"refreshInterval\":{\"value\":1000},\"timeCheckCount\":{\"value\":100},\"clearOnRestart\":{\"value\":true},\"withInputValue\":{\"value\":false}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":291.671875,\"y\":397,\"ports\":[{\"pos\":1.4562322443181819},{\"pos\":1.928174978956229},{\"pos\":0.505284597599912},{\"pos\":3.5},{\"pos\":3.5}]},{\"name\":\"bitmap\",\"type\":\"Bitmap\",\"props\":{\"fileName\":{\"value\":\"result.png\"},\"valueRange\":{\"value\":{\"vmin\":0,\"vmax\":1}},\"colorMap\":{\"value\":[{\"pos\":0,\"color\":16777215},{\"pos\":1,\"color\":0}]}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":293.671875,\"y\":460,\"ports\":[{\"pos\":1.5}]},{\"name\":\"proj\",\"type\":\"Projection\",\"props\":{\"indices\":{\"value\":[0,2]}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":307.671875,\"y\":320,\"ports\":[{\"pos\":1.5},{\"pos\":3.5}]},{\"name\":\"psec\",\"type\":\"CrossSection\",\"props\":{\"param\":{\"value\":{\"index\":1,\"pos\":0,\"flags\":[\"positive\"]}}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":303.65625,\"y\":255,\"ports\":[{\"pos\":1.283333169947455},{\"pos\":3.5}]},{\"name\":\"isInput\",\"type\":\"RangeInput\",\"props\":{\"param\":{\"value\":[{\"index\":0,\"name\":\"q1\",\"vmin\":0,\"vmax\":\"3.14159\",\"resolution\":1000},{\"index\":1,\"name\":\"q2\",\"vmin\":0,\"vmax\":\"3.14159\",\"resolution\":1000},{\"index\":2,\"name\":\"dq1\",\"vmin\":\"-10\",\"vmax\":\"10\",\"resolution\":1000},{\"index\":3,\"name\":\"dq2\",\"vmin\":\"-10\",\"vmax\":\"10\",\"resolution\":1000}]},\"restartOnInput\":{\"value\":false},\"activateBeforeRestart\":{\"value\":false}},\"status\":{\"level\":\"ok\",\"text\":\"Ok\"},\"x\":438,\"y\":190,\"ports\":[{\"pos\":2.9905073911718993},{\"pos\":1.5107034412955467},{\"pos\":2.3340277959764846}]}],\"links\":[{\"source\":{\"box\":\"solverParam\",\"port\":\"output\"},\"target\":{\"box\":\"solver\",\"port\":\"parameters\"}},{\"source\":{\"box\":\"solver\",\"port\":\"nextState\"},\"target\":{\"box\":\"psec\",\"port\":\"input\"}},{\"source\":{\"box\":\"psec\",\"port\":\"output\"},\"target\":{\"box\":\"proj\",\"port\":\"input\"}},{\"source\":{\"box\":\"ode\",\"port\":\"parameters\"},\"target\":{\"box\":\"odeParam\",\"port\":\"output\"}},{\"source\":{\"box\":\"ode\",\"port\":\"state\"},\"target\":{\"box\":\"solver\",\"port\":\"rhsState\"}},{\"source\":{\"box\":\"ode\",\"port\":\"oderhs\"},\"target\":{\"box\":\"solver\",\"port\":\"rhs\"}},{\"source\":{\"box\":\"canvas\",\"port\":\"input\"},\"target\":{\"box\":\"proj\",\"port\":\"output\"}},{\"source\":{\"box\":\"canvas\",\"port\":\"flush\"},\"target\":{\"box\":\"solver\",\"port\":\"finish\"}},{\"source\":{\"box\":\"canvas\",\"port\":\"output\"},\"target\":{\"box\":\"bitmap\",\"port\":\"input\"}},{\"source\":{\"box\":\"isInput\",\"port\":\"input\"},\"target\":{\"box\":\"initState\",\"port\":\"output\"}},{\"source\":{\"box\":\"solver\",\"port\":\"nextState\"},\"target\":{\"box\":\"isInput\",\"port\":\"activator\"}},{\"source\":{\"box\":\"solver\",\"port\":\"initState\"},\"target\":{\"box\":\"isInput\",\"port\":\"output\"}}]}"}